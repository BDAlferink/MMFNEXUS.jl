<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory · MMFNEXUS.jl</title><meta name="title" content="Theory · MMFNEXUS.jl"/><meta property="og:title" content="Theory · MMFNEXUS.jl"/><meta property="twitter:title" content="Theory · MMFNEXUS.jl"/><meta name="description" content="Documentation for MMFNEXUS.jl."/><meta property="og:description" content="Documentation for MMFNEXUS.jl."/><meta property="twitter:description" content="Documentation for MMFNEXUS.jl."/><meta property="og:url" content="https://BDAlferink.github.io/MMFNEXUS.jl/theory/"/><meta property="twitter:url" content="https://BDAlferink.github.io/MMFNEXUS.jl/theory/"/><link rel="canonical" href="https://BDAlferink.github.io/MMFNEXUS.jl/theory/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MMFNEXUS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Theory</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../citations/">citations</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theory</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/BDAlferink/MMFNEXUS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/BDAlferink/MMFNEXUS.jl/blob/main/docs/src/theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h1><p>MMF NEXUS is an algorithm for the identification of cosmic web environments. Clusters (nodes), filaments, sheets (walls), and voids are found in scale space to preserve the multiscale nature of the large scale distributions of matter. This packages concerns specifically the NEXUS+ procedure which computes the filtering in logarithmic space. </p><p>The algorithm is outlined by the following steps:</p><ol><li>Apply a gaussian filter with scale <span>$R_n$</span> to the input field.</li><li>Compute the eigenvalues of the Hessian matrix of the filtered field.</li><li>Compute signatures for each environment for each voxel of the density field.</li><li>Repeat the steps above for a number of different filtering scales.</li><li>Find the optimal environment signature, independant of scale.</li><li>Use a detection threshhold based on physical criteria.</li></ol><p>The environments are found hyrarchically, in the sense that first nodes are detected, then filaments, then walls, and anything not identified is considered a void. This is done as, for example, typically nodes have both a strong node and filament siganture, etc.</p><p>Below we elaborate on each step. This theory section is paraphrasiing the detailed explanation found in the original <a href="https://academic.oup.com/mnras/article/429/2/1286/1038906">NEXUS publication</a></p><h3 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h3><p>The gaussian filter of width <span>$R_n$</span> is applied in Fourier space. First for node identification, this is done on the density field <span>$f(\bm{x})$</span>,</p><p class="math-container">\[f_n(\bm{x}) = \int \frac{d^3k}{(2\pi)^3}e^{-k^2R_n^2/2} \hat{f}(\bm{k})e^{i\bm{k}\cdot\bm{x}},\]</p><p>where <span>$\hat{f}(\bm{k})$</span> is the fourier transform of the input field and <span>$f_n(\bm{x})$</span> is the filtered field. This is used for the input field when calculating the node signatures. They turn out to perform much worse when using the NEXUS+ procedure of filtering in logarithmic space.</p><p>For the signature calculations of the other environments, the log of the field f is first computed,</p><p class="math-container">\[g = \log_{10}{f},\]</p><p>and then smoothed with a gaussian filter,</p><p class="math-container">\[g_n(\bm{x}) = \int \frac{d^3k}{(2/pi)^3}e^{-k^2R_n^2/2} \hat{g}(\bm{k})e^{i\bm{k}\cdot\bm{x}},\]</p><p>where <span>$\hat{g}(\bm{k})$</span> is the fourier transform of the logarithm of the input field and <span>$g_n(\bm{x})$</span> is the logarithmic filtered field. To obtain the lograithmically filtered field, we exponantiate and renormalize the resulting field such that the mean remains the same as the input field,</p><p class="math-container">\[f_n(\bm{x}) = C_n 10^{g_n},\]</p><p>where <span>$C_n$</span> is the renormalization constant.</p><p>Usually, filtering is done over a range of scales naturally seperated as:</p><p class="math-container">\[R_n = (\sqrt{2})^n R_0,\]</p><p>where <span>$R_0$</span> is the minimum filtering scale and n is choosen to be a range of integers. Typical values are <span>$R_0 = 0.5 Mpc/h$</span> and <span>$n = 0, \ldots, 6$</span>.</p><h3 id="Signature-calculations"><a class="docs-heading-anchor" href="#Signature-calculations">Signature calculations</a><a id="Signature-calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Signature-calculations" title="Permalink"></a></h3><p>With this we can compute the Hessian of the the field for each voxel. The hessian is defined as,</p><p class="math-container">\[\begin{equation}
    H_{ij}(\bm{x},R_n) = R_n^2 \frac{\partial^2 f_n(\bm{x})}{\partial x_i \partial x_j}.
\end{equation}\]</p><p>This is also computed in Fourier space. the Hessian eigenvalues are calculated as,</p><p class="math-container">\[\det(H(\bm{x},R_n) - \lambda I) = 0,\]</p><p>where <span>$\lambda$</span> are the eigenvalues. The eigenvalues are ordered as <span>$\lambda_1 \leq \lambda_2 \leq \lambda_3$</span>.</p><p>With this, we find the morphological signature for each environment,</p><p class="math-container">\[\mathcal{S}(\bm{x}, R_n) = \begin{cases}
\frac{\lambda_3^2}{|\lambda_1|} \theta(-\lambda_1) \theta(-\lambda_2) \theta(-\lambda_3) &amp; \text{node}, \\
\frac{\lambda_2^2}{|\lambda_1|} \Theta\left(1 - \frac{|\lambda_3|}{|\lambda_1|} \right) \theta(-\lambda_1) \theta(-\lambda_2) &amp; \text{filament}, \\
|\lambda_1| \Theta\left(1 - \frac{|\lambda_2|}{|\lambda_1|} \right) \Theta\left(1 - \frac{|\lambda_3|}{|\lambda_1|} \right) \theta(-\lambda_1) &amp; \text{wall},
\end{cases}\]</p><p>where <span>$\Theta(x) = x \theta(x)$</span> and <span>$\theta(x)$</span> is the Heaviside step function. This classification is based on the insights of <a href="https://articles.adsabs.harvard.edu/pdf/1970A%26A.....5...84Z">Zel&#39;dovich 1970</a> and <a href="https://academic.oup.com/mnras/article/375/2/489/1441686">Hahn et al. 2007</a> on the geometry of the matter distribution based on the eigenvalues of the Hessian.</p><p>Then, for each point, the signature is choosen for the scale where the signature is maximum,</p><p class="math-container">\[\mathcal{S}(\bm{x}) = \max_{n} \mathcal{S}(\bm{x}, R_n),\]</p><p>which is a scale independant signature.</p><h3 id="Detection-thresholds"><a class="docs-heading-anchor" href="#Detection-thresholds">Detection thresholds</a><a id="Detection-thresholds-1"></a><a class="docs-heading-anchor-permalink" href="#Detection-thresholds" title="Permalink"></a></h3><p>For nodes, the threshold is determined by considering the fraction of valid nodes given the average density contrast contained in the identified nodes as a function of the signature threshold. This is done by identifying all clumps of adjacent voxels above a certain signature threshold as individual nodes. Then, the average density of each clump is calculated and compared to a given average density <span>$\Delta$</span> often taken as <span>$\Delta = 370$</span>. Increasing the cluster signature threshold will monotonically increase the fraction of valid nodes from near 0 to 1. The optimal threshold is then chosen as the signature corresponding to 50% valid nodes. In addition to this, we only consider nodes that contain a mass of at least <span>$10^{13} M_\odot$</span> to avoid spurious detections.</p><p>Filament and wall detection thresholds are determined by considering the change in mass contained in filaments/walls as a function of signature threshold. This is given by,</p><p class="math-container">\[\Delta M^2 = \left| \frac{dM^2}{d\log S} \right|, \]</p><p>where <span>$M$</span> is the mass contained in filaments/walls and <span>$S$</span> the signature threshold. The optimal signature threshold is then chosen as the signature corresponding to the peak in <span>$\Delta M^2$</span>. An additional requirement for the minimum volume of filaments and walls is chosen to be 1 <span>$(\text{Mpc}/h)^3$</span> and 2 <span>$(\text{Mpc}/h)^3$</span>, respectively.</p><h3 id="Variations"><a class="docs-heading-anchor" href="#Variations">Variations</a><a id="Variations-1"></a><a class="docs-heading-anchor-permalink" href="#Variations" title="Permalink"></a></h3><p>Discuss &quot;Normal&quot; NEXUS, shear, etc.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../tutorial/">Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 17 February 2026 20:56">Tuesday 17 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
